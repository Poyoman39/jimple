!function(e,t){if("function"==typeof define&&define.amd)define(["module"],t);else if("undefined"!=typeof exports)t(module);else{var i={exports:{}};t(i),e.Jimple=i.exports}}(this,function(e){"use strict";var t=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e};function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t){if(!e)throw new Error(t)}function s(e){return"function"==typeof e}function o(e,t){r(e.has(t),'Identifier "'+t+'" is not defined.')}function i(e,t){return r(s(t),"Service definition is not a Closure or invokable object"),e.add(t),t}var c=(t(a,null,[{key:"provider",value:function(e){return{register:e}}}]),t(a,[{key:"get",value:function(e){o(this,e);var t=this._items[e],i=void 0;return s(t)?this._protected.has(t)?i=t:this._instances.has(t)?i=this._instances.get(t):(i=t(this),this._factories.has(t)||this._instances.set(t,i)):i=t,i}},{key:"set",value:function(e,t){this._items[e]=t}},{key:"has",value:function(e){return this._items.hasOwnProperty(e)}},{key:"factory",value:function(e){return i(this._factories,e)}},{key:"protect",value:function(e){return i(this._protected,e)}},{key:"keys",value:function(){return Object.keys(this._items)}},{key:"extend",value:function(e,t){o(this,e);var i=this._items[e];r(s(i)&&!1===this._protected.has(i),"Identifier '"+e+"' does not contain a service definition"),r(s(t),"The 'new' service definition for '"+e+"' is not a invokable object."),this._items[e]=function(e){return t(i(e),e)},this._factories.has(i)&&(this._factories.delete(i),this._factories.add(this._items[e]))}},{key:"register",value:function(e){e.register(this)}},{key:"raw",value:function(e){return o(this,e),this._items[e]}}]),a);function a(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this._items={},this._instances=new Map,this._factories=new Set,this._protected=new Set,t=function(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}(t)?t:{},Object.keys(t).forEach(function(e){this.set(e,t[e])},this)}e.exports=c});